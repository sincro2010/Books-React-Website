{"ast":null,"code":"import { ActionCreator } from './action.js';\nimport { AuthorizationStatus, AppRoute, HttpCode, Status } from '../common/const.js';\nimport { adaptReviewToClient } from './adapter.js';\nexport const fetchBooksList = () => (next, _getState, api) => api.get(AppRoute.HOTELS).then(_ref => {\n  let {\n    data\n  } = _ref;\n  return next(ActionCreator.getOffers(data));\n}).catch(() => {});\nexport const fetchBook = id => (next, _getState, api) => api.get(`${'http://localhost:3002/books/get'}/${id}`).then(book => next(ActionCreator.getBook(book))).catch(err => {\n  const {\n    response\n  } = err;\n\n  switch (response.status) {\n    case HttpCode.NOT_FOUND:\n      next(ActionCreator.redirectToRoute(AppRoute.ERROR));\n      break;\n\n    default:\n      next(ActionCreator.setErrorMessage(response.status));\n      break;\n  }\n});\nexport const checkAuth = () => (next, _getState, api) => api.get('http://localhost:3002/login/get').then(_ref2 => {\n  let {\n    data\n  } = _ref2;\n  return next(ActionCreator.authorizationInfo(data));\n}).then(() => next(ActionCreator.requireAuthorization(AuthorizationStatus.AUTH))).catch(() => {});\nexport const logIn = _ref3 => {\n  let {\n    username: username,\n    email: email,\n    password: password\n  } = _ref3;\n  return (next, _getState, api) => api.post('http://localhost:3002/login/post', {\n    username,\n    email,\n    password\n  }).then(_ref4 => {\n    let {\n      data\n    } = _ref4;\n    return next(ActionCreator.authorizationInfo(data));\n  }).then(() => next(ActionCreator.requireAuthorization(AuthorizationStatus.AUTH))).then(() => next(ActionCreator.redirectToRoute(AppRoute.MAIN))).catch(() => {});\n};\nexport const logOut = () => (next, _getState, api) => api.get('http://localhost:3002/login/get').then(() => next(ActionCreator.authorizationInfo({}))).then(() => next(ActionCreator.requireAuthorization(AuthorizationStatus.NO_AUTH))).catch(() => {});\nexport const fetchBookReviews = id => (next, _getState, api) => api.get(`${'http://localhost:3002/comments/get'}/${id}`).then(_ref5 => {\n  let {\n    data\n  } = _ref5;\n  return next(ActionCreator.getReviews(data.map(review => adaptBookToClient(review))));\n}).catch(() => {});\nexport const sendBookReview = (id, _ref6) => {\n  let {\n    rating,\n    comment\n  } = _ref6;\n  return (next, _getState, api) => {\n    api.post(`${'http://localhost:3002/comments/post'}/${id}`, {\n      rating,\n      comment\n    }).then(_ref7 => {\n      let {\n        data\n      } = _ref7;\n      return next(ActionCreator.getReviews(data));\n    }).then(() => next(ActionCreator.statusReviewSending(Status.SUCCESS))).catch(() => next(ActionCreator.statusReviewSending(Status.ERROR)));\n  };\n};","map":{"version":3,"names":["ActionCreator","AuthorizationStatus","AppRoute","HttpCode","Status","adaptReviewToClient","fetchBooksList","next","_getState","api","get","HOTELS","then","data","getOffers","catch","fetchBook","id","book","getBook","err","response","status","NOT_FOUND","redirectToRoute","ERROR","setErrorMessage","checkAuth","authorizationInfo","requireAuthorization","AUTH","logIn","username","email","password","post","MAIN","logOut","NO_AUTH","fetchBookReviews","getReviews","map","review","adaptBookToClient","sendBookReview","rating","comment","statusReviewSending","SUCCESS"],"sources":["/Users/Pavel/Documents/учёба/Программирование/Файлы/Books/client/src/store/api-actions.js"],"sourcesContent":["import {ActionCreator} from './action.js';\nimport {AuthorizationStatus, AppRoute, HttpCode, Status} from '../common/const.js';\nimport {adaptReviewToClient} from './adapter.js';\n\nexport const fetchBooksList = () => (next, _getState, api) => (\n  api.get(AppRoute.HOTELS)\n    .then(({data}) => next(ActionCreator.getOffers(data)))\n    .catch(() => {})\n);\n\nexport const fetchBook = (id) => (next, _getState, api) => (\n  api.get(`${'http://localhost:3002/books/get'}/${id}`)\n    .then((book) => next(ActionCreator.getBook(book)))\n    .catch((err) => {\n      const {response} = err;\n      switch (response.status) {\n        case HttpCode.NOT_FOUND:\n          next(ActionCreator.redirectToRoute(AppRoute.ERROR));\n          break;\n        default:\n          next(ActionCreator.setErrorMessage(response.status));\n          break;\n      }\n    })\n);\n\nexport const checkAuth = () => (next, _getState, api) => (\n  api.get('http://localhost:3002/login/get')\n     .then(({data}) => next(ActionCreator.authorizationInfo(data)))\n     .then(() => next(ActionCreator.requireAuthorization(AuthorizationStatus.AUTH)))\n     .catch(() => {})\n);\n\nexport const logIn = ({username: username, email: email, password: password}) => (next, _getState, api) => (\n  api.post('http://localhost:3002/login/post', {username, email, password})\n    .then(({data}) => next(ActionCreator.authorizationInfo(data)))\n    .then(() => next(ActionCreator.requireAuthorization(AuthorizationStatus.AUTH)))\n    .then(() => next(ActionCreator.redirectToRoute(AppRoute.MAIN)))\n    .catch(() => {})\n);\n\nexport const logOut = () => (next, _getState, api) => (\n  api.get('http://localhost:3002/login/get')\n  .then(() => next(ActionCreator.authorizationInfo({})))\n  .then(() => next(ActionCreator.requireAuthorization(AuthorizationStatus.NO_AUTH)))\n  .catch(() => {})\n);\n\nexport const fetchBookReviews = (id) => (next, _getState, api) => (\n  api.get(`${'http://localhost:3002/comments/get'}/${id}`)\n    .then(({data}) => next(ActionCreator.getReviews(data.map((review) => adaptBookToClient(review)))))\n    .catch(() => {})\n);\n\nexport const sendBookReview = (id, {rating, comment}) => (next, _getState, api) => {\n  api.post(`${'http://localhost:3002/comments/post'}/${id}`, {rating, comment})\n    .then(({data}) => next(ActionCreator.getReviews(data)))\n    .then(() => next(ActionCreator.statusReviewSending(Status.SUCCESS)))\n    .catch(() => next(ActionCreator.statusReviewSending(Status.ERROR)));\n};\n\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}