{"ast":null,"code":"import { ActionCreator } from './action.js';\nimport { AuthorizationStatus, AppRoute, HttpCode, Status } from '../common/const.js';\nimport { adaptReaderToClient } from './adapter.js';\nexport const fetchBook = id => (dispatch, _getState, api) => api.get(`${'http://localhost:3002/books/get'}/${id}`).then(book => dispatch(ActionCreator.getBookPage(book.data))).catch(err => {\n  const {\n    response\n  } = err;\n\n  switch (response.status) {\n    case HttpCode.NOT_FOUND:\n      dispatch(ActionCreator.redirectToRoute(AppRoute.ERROR));\n      break;\n\n    default:\n      dispatch(ActionCreator.setErrorMessage(response.status));\n      break;\n  }\n});\nexport const fetchBooksList = () => (dispatch, _getState, api) => api.get('http://localhost:3002/books/get').then(_ref => {\n  let {\n    data\n  } = _ref;\n  return dispatch(ActionCreator.getBooks(data));\n}).catch(() => {});\nexport const fetchBookReviews = id => (dispatch, _getState, api) => api.get(`${'http://localhost:3002/comments/get'}/${id}`).then(_ref2 => {\n  let {\n    data\n  } = _ref2;\n  return dispatch(ActionCreator.getReviews(data));\n}).catch(() => {});\nexport const sendBookReview = (id, _ref3) => {\n  let {\n    rating,\n    comment,\n    username,\n    isPro,\n    avatarUrl\n  } = _ref3;\n  return (dispatch, _getState, api) => {\n    api.post(`${'http://localhost:3002/comments/post'}/${id}`, {\n      rating,\n      comment,\n      username,\n      isPro,\n      avatarUrl\n    }).then(_ref4 => {\n      let {\n        data\n      } = _ref4;\n      return dispatch(ActionCreator.getReviews(data));\n    }).then(() => dispatch(ActionCreator.statusReviewSending(Status.SUCCESS))).catch(() => dispatch(ActionCreator.statusReviewSending(Status.ERROR)));\n  };\n};\nexport const fetchBookReader = id => (dispatch, _getState, api) => api.get(`${'http://localhost:3002/reader/get'}/${id}`).then(_ref5 => {\n  let {\n    data\n  } = _ref5;\n  return dispatch(ActionCreator.getReader(data));\n}).catch(() => {});\nexport const checkAuth = () => (dispatch, _getState, api) => api.get('http://localhost:3002/login/get').then(_ref6 => {\n  let {\n    data\n  } = _ref6;\n  return dispatch(ActionCreator.authorizationInfo(data));\n}).then(() => dispatch(ActionCreator.requireAuthorization(AuthorizationStatus.AUTH))).catch(() => {});\nexport const logIn = _ref7 => {\n  let {\n    username,\n    email,\n    password,\n    isPro,\n    avatarUrl\n  } = _ref7;\n  return (dispatch, _getState, api) => api.post('http://localhost:3002/login/post', {\n    username,\n    email,\n    password,\n    isPro,\n    avatarUrl\n  }).then(_ref8 => {\n    let {\n      data\n    } = _ref8;\n    return dispatch(ActionCreator.authorizationInfo(data));\n  }).then(() => dispatch(ActionCreator.requireAuthorization(AuthorizationStatus.AUTH))).then(() => dispatch(ActionCreator.redirectToRoute(AppRoute.MAIN))).catch(() => {});\n};\nexport const logOut = () => (dispatch, _getState, api) => api.get('http://localhost:3002/login/get').then(() => dispatch(ActionCreator.authorizationInfo({}))).then(() => dispatch(ActionCreator.requireAuthorization(AuthorizationStatus.NO_AUTH))).catch(() => {});","map":{"version":3,"names":["ActionCreator","AuthorizationStatus","AppRoute","HttpCode","Status","adaptReaderToClient","fetchBook","id","dispatch","_getState","api","get","then","book","getBookPage","data","catch","err","response","status","NOT_FOUND","redirectToRoute","ERROR","setErrorMessage","fetchBooksList","getBooks","fetchBookReviews","getReviews","sendBookReview","rating","comment","username","isPro","avatarUrl","post","statusReviewSending","SUCCESS","fetchBookReader","getReader","checkAuth","authorizationInfo","requireAuthorization","AUTH","logIn","email","password","MAIN","logOut","NO_AUTH"],"sources":["/Users/Pavel/Documents/учёба/Программирование/Файлы/Books/client/src/store/api-actions.js"],"sourcesContent":["import {ActionCreator} from './action.js';\nimport {AuthorizationStatus, AppRoute, HttpCode, Status} from '../common/const.js';\nimport {adaptReaderToClient} from './adapter.js';\n\n\nexport const fetchBook = (id) => (dispatch, _getState, api) => (\n  api.get(`${'http://localhost:3002/books/get'}/${id}`)\n    .then((book) => dispatch(ActionCreator.getBookPage(book.data)))\n    .catch((err) => {\n      const {response} = err;\n      switch (response.status) {\n        case HttpCode.NOT_FOUND:\n          dispatch(ActionCreator.redirectToRoute(AppRoute.ERROR));\n          break;\n        default:\n          dispatch(ActionCreator.setErrorMessage(response.status));\n          break;\n      }\n    })\n);\nexport const fetchBooksList = () => (dispatch, _getState, api) => (\n  api.get('http://localhost:3002/books/get')\n    .then(({data}) => dispatch(ActionCreator.getBooks(data)))\n    .catch(() => {})\n);\n\n\n\nexport const fetchBookReviews = (id) => (dispatch, _getState, api) => (\n  api.get(`${'http://localhost:3002/comments/get'}/${id}`)\n    .then(({data}) => dispatch(ActionCreator.getReviews(data)))\n    .catch(() => {})\n);\n\nexport const sendBookReview = (id, {rating, comment, username, isPro, avatarUrl}) => (dispatch, _getState, api) => {\n  api.post(`${'http://localhost:3002/comments/post'}/${id}`, {rating, comment, username, isPro, avatarUrl})\n    .then(({data}) => dispatch(ActionCreator.getReviews(data)))\n    .then(() => dispatch(ActionCreator.statusReviewSending(Status.SUCCESS)))\n    .catch(() => dispatch(ActionCreator.statusReviewSending(Status.ERROR)));\n};\n\nexport const fetchBookReader = (id) => (dispatch, _getState, api) => (\n  api.get(`${'http://localhost:3002/reader/get'}/${id}`)\n    .then(({data}) => dispatch(ActionCreator.getReader(data)))\n    .catch(() => {})\n);\n\nexport const checkAuth = () => (dispatch, _getState, api) => (\n  api.get('http://localhost:3002/login/get')\n     .then(({data}) => dispatch(ActionCreator.authorizationInfo(data)))\n     .then(() => dispatch(ActionCreator.requireAuthorization(AuthorizationStatus.AUTH)))\n     .catch(() => {})\n);\n\nexport const logIn = ({username, email, password, isPro, avatarUrl}) => (dispatch, _getState, api) => (\n  api.post('http://localhost:3002/login/post', {username, email, password, isPro, avatarUrl})\n    .then(({data}) => dispatch(ActionCreator.authorizationInfo(data)))\n    .then(() => dispatch((ActionCreator.requireAuthorization(AuthorizationStatus.AUTH))))\n    .then(() => dispatch(ActionCreator.redirectToRoute(AppRoute.MAIN)))\n    .catch(() => {})\n);\n\nexport const logOut = () => (dispatch, _getState, api) => (\n  api.get('http://localhost:3002/login/get')\n  .then(() => dispatch(ActionCreator.authorizationInfo({})))\n  .then(() => dispatch(ActionCreator.requireAuthorization(AuthorizationStatus.NO_AUTH)))\n  .catch(() => {})\n);\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}